<#-- @license ©2015 Miel Vander Sande - Multimedia Lab / iMinds / Ghent University -->
<#setting url_escaping_charset='UTF-8'>
<div resource="${datasourceUrl}" typeof="void:datasource hydra:Collection">
    <h2><a href="${datasourceUrl}">${datasource.getTitle()?cap_first}</a></h2>

    <form action="?" method="GET" property="hydra:search" resource="#triplePattern">
        <fieldset resource="#triplePattern">
            <legend>Query ${datasource.getTitle()} by triple pattern</legend>
            <ul>
                <#list ['subject', 'predicate', 'object'] as component>
                <li property="hydra:mapping" resource="#${component}">
                    <label about="#${component}"
                           for="${component}>" lang="" property="hydra:variable">${component}</label>
                    <input about="#${component}" class="uri" id="${component}"
                           name="${component}" property="hydra:property" resource="rdf:${component}"
                           value="${(query[component]?html)!""}" />
                </li>
            </
            #list>
            </ul>
        </fieldset>
        <p>
            <input type="submit" value="Find matching triples"/>
        </p>
    </form>
</div>

<h3>Matches in ${datasource.getTitle()} for <em class="pattern">${ (query["pattern"]?html)!"" }</em></h3>

<div class="counts">
    <#if (triples?size > 0)>
    Showing triples ${ start } to ${ end } of
    <#if totalEstimate != end>±
</#if>
<span content="${ totalEstimate }" datatype="xsd:integer"
      property="void:triples hydra:totalItems">${ totalEstimate }</span>
with <span content="${ itemsPerPage }" datatype="xsd:integer" property="hydra:itemsPerPage">${
    itemsPerPage
  }</span> triples per page.
<@pageLinks/>
<#else>
<p>
    ${datasource.getTitle()} contains
    <span content="0" datatype="xsd:integer" property="void:triples hydra:totalItems">
      no <#if (totalEstimate > 0) >more</#if>
    </span>
    triples that match this pattern.
</p>
</#if>
</div>

<ul class="triples">
    <#list triples as triple>
    <#assign subject = triple.getSubject().asNode().toString()>
    <#assign predicate = triple.getPredicate().asNode().toString()>
    <#assign object = triple.getObject().asNode().toString()>
    <li>
        <a href="?subject=${subject?url}">
            <abbr title="${ subject }">${subject?keep_after_last("/")}</abbr>
        </a>
        <a href="?predicate=${predicate?url}">
            <abbr title="${ predicate }">${predicate?keep_after_last("/")}</abbr>
        </a>
        <#if !triple.getObject().isLiteral()>
        <a href="?object=${object?url}" resource="${ subject}">
            <abbr property="${ predicate }" resource="${ object }"
                  title="${ object }">${object?keep_after_last("/")}</abbr>
        </a>.
        <#else>
        <a href="?object=${object?url}" resource="${ subject}">${object}</a>.
    </
    #if>
    </li>
</#list>
</ul>

<@pageLinks/>

<#macro pageLinks>
<ul class="links">
    <#if previousPage??>
    <li><a href="${ firstPage }" property="hydra:firstPage" rel="first">first</a></li>
    <li><a href="${ previousPage }" property="hydra:previousPage" rel="prev">previous</a></li>
</#if>
<#if nextPage??>
<li><a href="${ nextPage }" property="hydra:nextPage" rel="next">next</a></li>
</#if>
</ul>
</#macro>
